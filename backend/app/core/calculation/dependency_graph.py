# DAG construction and topological sort